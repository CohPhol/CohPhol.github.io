<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Guess the Word!!</title>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #f4f4f4;
      text-align: center;
      padding: 30px;
    }

    h1 {
      margin-bottom: 10px;
    }

    #phrase {
      font-size: 2em;
      letter-spacing: 10px;
      margin-bottom: 20px;
    }

    #keyboard {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      max-width: 600px;
      margin: auto;
    }

    .key {
      margin: 5px;
      padding: 10px 15px;
      background: #008cba;
      color: white;
      border: none;
      border-radius: 5px;
      font-size: 1em;
      cursor: pointer;
    }

    .key:disabled {
      background: #ccc;
      cursor: not-allowed;
    }

    #status {
      margin-top: 20px;
      font-size: 1.2em;
    }

    #lives {
      font-weight: bold;
      color: #c00;
    }

    #retryBtn {
      margin-top: 20px;
      padding: 10px 20px;
      font-size: 1em;
      background-color: #28a745;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      display: none;
    }

    #retryBtn:hover {
      background-color: #218838;
    }
  </style>
</head>

<body>

  <h1>Guess the Word!!</h1>
  <div id="phrase"></div>
  <div id="keyboard"></div>
  <div id="status">Lives left: <span id="lives">3</span></div>
  <div id="responseButtons" style="display:none; margin-top: 20px;">
    <button onclick="handleAnswer(true)" style="padding:10px 20px; margin-right:10px; font-size:1em;">Yes ðŸ’–</button>
    <button onclick="handleAnswer(false)" style="padding:10px 20px; font-size:1em;">No ðŸ˜¢</button>
  </div>
  <button id="retryBtn" onclick="location.reload()">Retry</button>

  <script>
    const phrases = [
      "CAN I BE YOUR BOYFRIEND?",
      "TAYO NA BA?",
    ];

    const phrase = phrases[Math.floor(Math.random() * phrases.length)];
    let guessed = [];
    let lives = 3;

    const phraseDiv = document.getElementById('phrase');
    const keyboard = document.getElementById('keyboard');
    const status = document.getElementById('status');
    const livesSpan = document.getElementById('lives');
    const retryBtn = document.getElementById('retryBtn');
    const responseButtons = document.getElementById('responseButtons');

    function renderPhrase() {
      phraseDiv.innerHTML = phrase.split('').map(letter => {
        if (letter === ' ') return '&nbsp;';
        return guessed.includes(letter) ? letter : '_';
      }).join(' ');
    }

    function checkWin() {
      if (!phrase.split('').some(l => l !== ' ' && !guessed.includes(l))) {
        status.innerHTML = "I like you po <3<br>Ano sagot mo?";
        disableKeyboard();
        responseButtons.style.display = 'block';
      }
    }

    function checkLoss() {
      if (lives <= 0) {
        status.innerHTML = `Sad T^T Uulitin mo ba?`;
        retryBtn.style.display = 'inline-block';
        disableKeyboard();
      }
    }

    function handleAnswer(isYes) {
      if (isYes) {
        confetti({
          particleCount: 150,
          spread: 100,
          origin: { y: 0.6 }
        });
        status.innerHTML = "Ngiti ka ngaaaaaa<br>Opening Messenger in 3 seconds...";

        setTimeout(() => {
          window.open('https://m.me/cohphol', '_blank');
        }, 3000);
      } else {
        status.innerHTML = "Pagalit eyebrow dapat!!!<br>Closing tab in 3 seconds...";
        setTimeout(() => {
          window.close();
        }, 3000);
      }
      responseButtons.style.display = 'none';
    }

    function disableKeyboard() {
      document.querySelectorAll('.key').forEach(btn => btn.disabled = true);
    }

    function handleGuess(letter, button) {
      button.disabled = true;
      if (phrase.includes(letter)) {
        guessed.push(letter);
        renderPhrase();
        checkWin();
      } else {
        lives--;
        livesSpan.textContent = lives;
        status.innerHTML = getRandomInsult();
        checkLoss();
      }
    }

    function createKeyboard() {
      const letters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ?!.";
      letters.split('').forEach(letter => {
        const btn = document.createElement('button');
        btn.className = 'key';
        btn.textContent = letter;
        btn.onclick = () => handleGuess(letter, btn);
        keyboard.appendChild(btn);
      });
    }

    function getRandomInsult() {
      const insults = [
        "Okay",
        "OKAY",
        "KK",
        "K",
      ];
      return `Lives left: <span id="lives">${lives}</span> â€” ${insults[Math.floor(Math.random() * insults.length)]}`;
    }

    // Init
    renderPhrase();
    createKeyboard();

    // Physical keyboard support
    document.addEventListener('keydown', (e) => {
      const key = e.key.toUpperCase();
      if (!/^[A-Z?!.]$/.test(key)) return;
      if (guessed.includes(key)) return;
      const button = Array.from(document.querySelectorAll('.key')).find(btn => btn.textContent === key && !btn.disabled);
      if (button) {
        button.click();
      }
    });
  </script>

</body>

</html>