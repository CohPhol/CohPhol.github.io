<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lenticular Animation</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css">
  <style>
    body {
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      background: #222;
      overflow: hidden;
      margin: 0;
    }

    .card {
      display: flex;
      --boards: 16;
      --dimension: calc(var(--boards) * 3px);
      --width: calc(var(--dimension) / var(--boards));
      transform-style: preserve-3d;
      transform: rotateY(var(--angle, -42deg));
      list-style: none;
      padding: 0;
    }

    li {
      height: var(--dimension);
      width: var(--width);
      position: relative;
      transform-style: preserve-3d;
    }

    li::before,
    li::after {
      background-repeat: no-repeat;
      background-size: var(--dimension) calc(var(--dimension) * 9 / 16);
      background-position: calc(var(--offset-x, 0) * var(--dimension)) center;
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      transform: rotateY(calc(60deg * var(--direction, -1)));
      transform-origin: var(--origin-x, 100%) 50% 0px;
    }

    li::before {
      background-image: url('./assets/images/2.jpg');
    }

    li::after {
      background-image: url('./assets/images/1.jpg');
      --direction: 1;
      --origin-x: 0%;
    }
  </style>
</head>

<body>
  <ul class="card">
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
  </ul>

  <script>
    const card = document.querySelector('.card');
    const boards = Array.from(card.querySelectorAll('li'));

    // Set CSS variable for the number of boards
    card.style.setProperty('--boards', boards.length);

    boards.forEach((board, i) => {
      board.style.setProperty('--offset-x', -i / (boards.length - 1));
    });

    let startX = 0;
    let currentAngle = -42;  // Initial angle
    const TOTAL_DEGREES = 84;
    const MAX_ANGLE = 42;

    function updateAngle(newX) {
      const delta = newX - startX;
      const percentage = delta / window.innerWidth;
      currentAngle = Math.max(-MAX_ANGLE, Math.min(MAX_ANGLE, currentAngle + percentage * TOTAL_DEGREES));
      card.style.setProperty('--angle', `${currentAngle}deg`);
    }

    card.addEventListener('mousedown', (e) => {
      e.preventDefault();
      startX = e.clientX;
      card.style.animation = 'none';
      document.addEventListener('mousemove', onMove);
      document.addEventListener('mouseup', onEnd);
    });

    card.addEventListener('touchstart', (e) => {
      startX = e.touches[0].clientX;
      card.style.animation = 'none';
      document.addEventListener('touchmove', onMoveTouch);
      document.addEventListener('touchend', onEnd);
    });

    function onMove(e) {
      updateAngle(e.clientX);
    }

    function onMoveTouch(e) {
      updateAngle(e.touches[0].clientX);
    }

    function onEnd() {
      document.removeEventListener('mousemove', onMove);
      document.removeEventListener('touchmove', onMoveTouch);
      document.removeEventListener('mouseup', onEnd);
      document.removeEventListener('touchend', onEnd);
    }

    // Adjust step on window resize
    window.addEventListener('resize', () => {
      currentAngle = -42;
      card.style.setProperty('--angle', `${currentAngle}deg`);
    });
  </script>
</body>

</html>